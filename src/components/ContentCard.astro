---
import { getPhase } from '../config/graphics';

interface Props {
  title: string;
  description: string;
  href: string;
  tags?: string[];
  phaseId?: 'overview' | 'discovery' | 'strategy' | 'execution' | 'scale';
  meta?: string; // e.g., "8 min read" or "2024" or "Client Name"
  featured?: boolean;
}

const { title, description, href, tags = [], phaseId, meta, featured = false } = Astro.props;

const phase = phaseId ? getPhase(phaseId === 'overview' ? 25 : phaseId === 'discovery' ? 85 : phaseId === 'strategy' ? 170 : phaseId === 'execution' ? 290 : 460) : null;
---

<article
  class:list={[
    'group relative overflow-hidden rounded-xl border transition-all duration-300',
    'hover:scale-[1.02] hover:shadow-2xl',
    featured
      ? 'border-spiral-accent bg-gradient-to-br from-spiral-dark to-spiral-dark/50'
      : 'border-gray-800 bg-spiral-dark/80',
  ]}
>
  {featured && (
    <div class="absolute top-4 right-4 z-10">
      <span class="inline-flex items-center rounded-full bg-spiral-accent px-3 py-1 text-xs font-semibold text-spiral-dark">
        Destacado
      </span>
    </div>
  )}

  {phase && (
    <div
      class="absolute top-0 left-0 h-1 w-full"
      style={`background-color: ${phase.color}`}
    />
  )}

  <a
    href={href}
    class="block p-6 focus:outline-none focus:ring-2 focus:ring-spiral-accent focus:ring-offset-2 focus:ring-offset-spiral-dark"
    tabindex="0"
  >
    <div class="mb-4">
      <h3 class="mb-2 text-xl font-bold text-spiral-light group-hover:text-spiral-accent transition-colors">
        {title}
      </h3>
      
      {meta && (
        <p class="text-sm text-gray-400 mb-2">
          {meta}
        </p>
      )}
      
      <p class="text-gray-300 leading-relaxed line-clamp-3">
        {description}
      </p>
    </div>

    {tags.length > 0 && (
      <div class="flex flex-wrap gap-2 mt-4">
        {tags.slice(0, 4).map((tag) => (
          <span class="inline-flex items-center rounded-md bg-gray-800 px-2 py-1 text-xs font-medium text-gray-300 ring-1 ring-inset ring-gray-700">
            {tag}
          </span>
        ))}
        {tags.length > 4 && (
          <span class="inline-flex items-center rounded-md bg-gray-800 px-2 py-1 text-xs font-medium text-gray-400">
            +{tags.length - 4}
          </span>
        )}
      </div>
    )}

    <div class="mt-4 flex items-center text-sm font-medium text-spiral-accent">
      <span>Leer m√°s</span>
      <svg
        class="ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"
        />
      </svg>
    </div>
  </a>
</article>

